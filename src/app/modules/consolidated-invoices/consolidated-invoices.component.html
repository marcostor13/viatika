<div class="p-5 flex flex-col gap-4">
  <h1 class="text-2xl font-bold">Consolidado de Facturas</h1>

  <!-- Dashboard de facturas por proyecto -->
  <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
    <h2 class="text-lg font-semibold mb-2">Dashboard: Facturas por Proyecto</h2>
    <div class="flex flex-wrap gap-4">
      @for (project of invoicesByProject | keyvalue; track project.key) {
      <div
        class="bg-white border border-blue-100 rounded-lg px-4 py-2 shadow text-center min-w-[120px]"
      >
        <div class="font-bold text-blue-700">{{ project.key }}</div>
        <div class="text-2xl font-bold">{{ project.value }}</div>
        <div class="text-xs text-gray-500">facturas</div>
      </div>
      } @if ((invoicesByProject | keyvalue).length === 0) {
      <div class="text-gray-500">No hay facturas para mostrar.</div>
      }
    </div>
  </div>

  <form class="grid grid-cols-1 gap-2 md:grid-cols-6 w-full">
    <input
      type="text"
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      placeholder="Proyecto"
      [ngModel]="filterProject()"
      (ngModelChange)="filterProject.set($event)"
      name="project"
    />
    <select
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      [ngModel]="filterCategory()"
      (ngModelChange)="filterCategory.set($event)"
      name="category"
    >
      <option value="">Todas las categorías</option>
      <option value="Comida">Comida</option>
      <option value="Transporte">Transporte</option>
      <option value="Hospedaje">Hospedaje</option>
      <option value="Otros">Otros</option>
    </select>
    <input
      type="date"
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      placeholder="Desde"
      [ngModel]="filterDateFrom()"
      (ngModelChange)="filterDateFrom.set($event)"
      name="dateFrom"
    />
    <input
      type="date"
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      placeholder="Hasta"
      [ngModel]="filterDateTo()"
      (ngModelChange)="filterDateTo.set($event)"
      name="dateTo"
    />
    <input
      type="number"
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      placeholder="Monto mínimo"
      [ngModel]="filterAmountMin()"
      (ngModelChange)="filterAmountMin.set($event)"
      name="amountMin"
      min="0"
    />
    <input
      type="number"
      class="w-full px-4 py-2 rounded-lg border border-blue-100 bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-200 text-sm"
      placeholder="Monto máximo"
      [ngModel]="filterAmountMax()"
      (ngModelChange)="filterAmountMax.set($event)"
      name="amountMax"
      min="0"
    />
  </form>
</div>

<div class="px-5 lg:block hidden">
  <app-table
    [headers]="headers"
    [data]="filteredInvoices"
    (optionsEvent)="clickOptions($event.option, $event._id)"
  ></app-table>
</div>

<div class="px-5 block lg:hidden">
  <app-list-table
    [headers]="headers"
    [data]="filteredInvoices"
    (clickOptionsEvent)="clickOptions($event.option, $event._id)"
  ></app-list-table>
</div>
