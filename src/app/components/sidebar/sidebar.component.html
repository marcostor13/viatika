<div class="flex min-h-screen">
  <!-- Desktop Sidebar -->
  <div class="hidden lg:flex lg:w-[290px] bg-quaternary flex-col shadow-soft">
    <!-- Logo Section -->
    <div class="p-6 border-b border-tertiary/20">
      <div class="flex items-center justify-center">
        <img src="logo.svg" alt="logo" width="160" />
      </div>
    </div>

    <!-- Navigation -->
    <nav class="flex-1 p-4 space-y-1">
      @if (isColaborador()) {
      <a
        [routerLink]="['/invoices']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/invoices')"
        [class.text-quaternary]="isSelected('/invoices')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Facturas</span>
      </a>
      } @if (isAdmin()) {
      @if (!isSuper()) {
      <a
        [routerLink]="['/invoice-approval']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/invoice-approval')"
        [class.text-quaternary]="isSelected('/invoice-approval')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Aprobación de Facturas</span>
      </a>
      }

      @if (isSuper()) {
      <a
        [routerLink]="['/clients-admin']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/clients-admin')"
        [class.text-quaternary]="isSelected('/clients-admin')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Clientes</span>
      </a>
      }

      <a
        [routerLink]="['/admin-users']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/admin-users')"
        [class.text-quaternary]="isSelected('/admin-users')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Usuarios Admin</span>
      </a>

      @if (!isSuper()) {
      <a
        [routerLink]="['/consolidated-invoices']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/consolidated-invoices')"
        [class.text-quaternary]="isSelected('/consolidated-invoices')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Consolidado</span>
      </a>

      <a
        [routerLink]="['/configuracion']"
        routerLinkActive="bg-primary text-white"
        [class.bg-primary]="isSelected('/configuracion')"
        [class.text-quaternary]="isSelected('/configuracion')"
        class="flex items-center px-4 py-3 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
      >
        <span class="font-medium">Configuración</span>
      </a>
      }
      }
    </nav>

    <!-- User Section -->
    <div class="p-4 border-t border-tertiary/20">
      <div class="flex items-center px-4 py-2 text-secondary mb-3">
        <div
          class="w-8 h-8 rounded-full mr-3 flex items-center justify-center bg-background"
        >
          <img
            *ngIf="companyConfig?.logo"
            class="w-8 h-8 rounded-full object-cover"
            [src]="companyConfig?.logo"
            [alt]="companyConfig?.businessName || 'Logo de la empresa'"
          />
          <svg
            *ngIf="!companyConfig?.logo"
            class="w-5 h-5 text-tertiary"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
            />
          </svg>
        </div>
        <div class="text-sm">
          <div class="font-medium text-secondary">
            {{ user?.name || "Usuario" }}
          </div>
          <div class="text-xs text-tertiary">
            {{ user?.role?.name }}
          </div>
        </div>
      </div>
      <button
        (click)="confirmation()"
        class="flex items-center w-full px-4 py-2 text-tertiary rounded-xl hover:text-error hover:bg-background transition-all duration-200 group"
      >
        <span class="mr-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-5"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"
            />
          </svg>
        </span>
        <span class="font-medium">Cerrar Sesión</span>
      </button>
    </div>
  </div>

  <!-- Mobile Sidebar (Drawer) -->
  @if (sidebarVisible) {
  <div class="lg:hidden fixed inset-0 z-50 flex" (click)="toggleSidebar()">
    <div
      class="fixed inset-0 bg-secondary/50 backdrop-blur-sm transition-all duration-300"
    ></div>

    <div
      class="relative flex flex-col w-80 max-w-[85vw] bg-quaternary shadow-2xl"
      (click)="$event.stopPropagation()"
    >
      <!-- Mobile Header -->
      <div class="p-6 border-b border-tertiary/20">
        <div class="flex items-center justify-between">
          <div class="flex items-center justify-center flex-1">
            <img src="logo.svg" alt="logo" width="160" />
          </div>
          <button
            (click)="toggleSidebar()"
            class="p-2 text-tertiary hover:text-secondary hover:bg-background rounded-xl transition-all duration-200 group"
          >
            <svg
              class="w-6 h-6 transform group-hover:rotate-90 transition-transform duration-200"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              ></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Mobile Navigation -->
      <nav class="flex-1 p-6 space-y-2 overflow-y-auto">
        @if (isColaborador()) {
        <a
          [routerLink]="['/invoices']"
          (click)="toggleSidebar()"
          [class.bg-primary]="isSelected('/invoices')"
          [class.text-quaternary]="isSelected('/invoices')"
          class="flex items-center px-4 py-4 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
        >
          <span class="font-medium text-lg">Facturas</span>
        </a>
        } @if (isAdmin()) {
        @if (!isSuper()) {
        <a
          [routerLink]="['/invoice-approval']"
          (click)="toggleSidebar()"
          [class.bg-primary]="isSelected('/invoice-approval')"
          [class.text-quaternary]="isSelected('/invoice-approval')"
          class="flex items-center px-4 py-4 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
        >
          <span class="font-medium text-lg">Aprobación de Facturas</span>
        </a>

        <a
          [routerLink]="['/consolidated-invoices']"
          (click)="toggleSidebar()"
          [class.bg-primary]="isSelected('/consolidated-invoices')"
          [class.text-quaternary]="isSelected('/consolidated-invoices')"
          class="flex items-center px-4 py-4 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
        >
          <span class="font-medium text-lg">Consolidado</span>
        </a>

        <a
          [routerLink]="['/configuracion']"
          (click)="toggleSidebar()"
          [class.bg-primary]="isSelected('/configuracion')"
          [class.text-quaternary]="isSelected('/configuracion')"
          class="flex items-center px-4 py-4 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
        >
          <span class="font-medium text-lg">Configuración</span>
        </a>
        }

        <a
          [routerLink]="['/admin-users']"
          (click)="toggleSidebar()"
          [class.bg-primary]="isSelected('/admin-users')"
          [class.text-quaternary]="isSelected('/admin-users')"
          class="flex items-center px-4 py-4 text-secondary rounded-xl hover:bg-background hover:text-primary transition-all duration-200 group"
        >
          <span class="font-medium text-lg">Usuarios Admin</span>
        </a>
        }
      </nav>

      <!-- Mobile User Section -->
      <div class="p-6 border-t border-tertiary/20">
        <div
          class="flex items-center px-4 py-3 text-secondary mb-4 bg-background rounded-xl"
        >
          <div
            class="w-10 h-10 rounded-full mr-3 flex items-center justify-center bg-quaternary"
          >
            <img
              *ngIf="companyConfig?.logo"
              class="w-10 h-10 rounded-full object-cover"
              [src]="companyConfig?.logo"
              [alt]="companyConfig?.businessName || 'Logo de la empresa'"
            />
            <svg
              *ngIf="!companyConfig?.logo"
              class="w-6 h-6 text-tertiary"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
              />
            </svg>
          </div>
          <div class="text-sm">
            <div class="font-semibold text-secondary">
              {{ user?.name || "Usuario" }}
            </div>
            <div class="text-xs text-tertiary">
              {{ user?.role?.name }}
            </div>
          </div>
        </div>
        <button
          (click)="confirmation()"
          class="flex items-center w-full px-4 py-3 text-tertiary rounded-xl hover:text-error hover:bg-background transition-all duration-200 group"
        >
          <span class="mr-3 text-xl">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="size-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M8.25 9V5.25A2.25 2.25 0 0 1 10.5 3h6a2.25 2.25 0 0 1 2.25 2.25v13.5A2.25 2.25 0 0 1 16.5 21h-6a2.25 2.25 0 0 1-2.25-2.25V15m-3 0-3-3m0 0 3-3m-3 3H15"
              />
            </svg>
          </span>
          <span class="font-medium">Cerrar Sesión</span>
        </button>
      </div>
    </div>
  </div>
  }
</div>
